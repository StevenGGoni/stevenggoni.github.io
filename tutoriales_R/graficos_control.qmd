---
title: "Gráficos de control de Shewhart para variables"
date: today
format:
  html:
    toc: true
    collapse-sections: true
execute:
  warning: false
  message: false
---

# Introducción

El control estadístico del proceso implica la comparación de la salida del proceso con un estándar y la toma de decisiones intermedias en caso de discrepancia entre las dos.

También implica determinar si el proceso puede producir productos que cumplan con las especificaciones requeridas.

Los resultados de todos los procesos, ya sean procesos de fabricación o procesos que proporcionan algún tipo de servicio, están sujetos a la variabilidad. La variabilidad hace que sea más difícil para los procesos generar productos que se ajusten a los límites de especificación deseados.

Shewhart (1931) definió las dos causas de variabilidad en los resultados del proceso como causas comunes y causas especiales o asignables.

-   Las causas comunes de variabilidad se deben a la naturaleza inherente del proceso. No pueden eliminarse o reducirse sin cambiar el proceso real.

-   Las causas atribuibles de la variabilidad, por otra parte, son interrupciones inusuales del funcionamiento normal. Deben identificarse y eliminarse para reducir la variabilidad y hacer que el proceso sea más capaz de cumplir las especificaciones.

## Gráficos de control

Los gráficos de control son herramientas estadísticas. Su uso es la forma más eficaz de distinguir entre causa común y atribuible para la variabilidad cuando se supervisa el resultado del proceso en tiempo real. Aunque los gráficos de control por sí solos no pueden reducir la variabilidad del proceso, pueden ayudar a prevenir una reacción excesiva a las causas comunes de la variabilidad (lo que puede empeorar las cosas) y ayudar a evitar ignorar las señales de causa asignables. Cuando se reconoce la presencia de una causa asignable para la variabilidad, el conocimiento del proceso puede llevar a ajustes para eliminar esta causa y reducir la variabilidad en los resultados del proceso.

### Fase 1

En la fase I, se utilizan gráficos de control sobre datos retrospectivos para calcular los límites preliminares de control y determinar si el proceso había estado bajo control durante el período en que se recopilaron los datos. Cuando se detectan causas asignables en la carta de control utilizando los datos históricos, se lleva a cabo una investigación para encontrar la causa. Si se encuentra la causa y puede prevenirse en el futuro, se eliminan los datos correspondientes a los puntos fuera de control del gráfico y se vuelven a calcular los límites de control.

Este es normalmente un proceso iterativo y se repite hasta que los límites de los gráficos de control se refinan, se produce ub gráfico que no parece contener ninguna causa asignable, y el proceso parece estar funcionando a un nivel aceptable. La información obtenida a partir del gráfico de control de la fase I se utiliza entonces como base para el seguimiento de la fase II. Dado que los límites del gráfico de control se calculan repetidamente en la fase I, los cálculos se realizan normalmente utilizando un ordenador.

# Librerías

```{r}

library(tidyverse)
library(qcc)

```

# Gráficos $\bar{X}-R$

Para ejemplificar el uso de este gráfico se emplean los siguientes datos sobre fabricación de bobinas. Para cada bobina muestreada se mide la resistencia en ohms.

<a href="datos/bobinas.csv" download>Descargar datos</a>

```{r}

bobinas <- readr::read_csv("datos/bobinas.csv")

head(bobinas) %>% 
  flextable::flextable()

```

Note como el conjunto de datos ya está acomodado en subgrupos racionales de tamaño 5.

```{r}

Xbar <- qcc::qcc(bobinas,
                 type = "xbar",
                 title = "Gráfico de control X para Bobinas [ohms]", 
                 ylab = "Media del proceso", 
                 xlab = "Grupo")

R <- qcc::qcc(bobinas,
              type = "R",
              title = "Gráfico de control R para Bobinas [ohms]")

```

# Gráficos $\bar{X}-S$

En términos de código, basta con cambiar $R$ por $S$

```{r}

Xbar <- qcc::qcc(bobinas,
                 type = "xbar", 
                 title = "Gráfico de control X para Bobinas [ohms]")
S <- qcc::qcc(bobinas,
              type = "S",
              title = "Gráfico de control S para Bobinas [ohms]")

```

Como el tamaño del subgrupo es pequeño, la diferencia entre $R$ y $S$ es pequeña.

# Gráficos $I-mR$

Cuando se requieran gráficos individuales, se puede recurrir a este código.

Por ejemplo, utilicemos estos datos

```{r}

minutos <- c(15,17,18,20,21,16,17,18,15.5,16,22,28,21.5,16,
             17,16,18,17,19,21,27.5,17.5,21,16,18.75,21.5)


```

Y de est manera logramos obtener el gráfico.

```{r}

ImR <- qcc::qcc(minutos, type = "xbar.one", std.dev = "MR", 
                title = "Gráfico de control para minutos")

```

En este caso, el código solo es capaz de producir el gráfico individual, pero no el de rangos móviles (MR).

# ¿Cómo modificar valores?

Si se desea establecer otros límites de control, el centro o nominal del proceso, u otros detalles, puede consultar la documentación de la función con `help(qcc)`

# Bibliografía

-   Lawson, J. (2021). An Introduction to acceptance sampling and SPC with R. CRC Press.
